<div class="cbs-repayment-form">
    <form novalidate [formGroup]="repaymentForm" class="slds-form--stacked">
        <cbs-form-date-control
            [formControlName]="'date'"
            [validateDate]="true"
            [requiredField]="true"
            [hasError]="repaymentForm.get('date').errors && repaymentForm.get('date').touched"
            fieldLabel="{{ 'DATE' | translate }}"
            (onChange)="repaymentDateChanged()"
        ></cbs-form-date-control>

        <cbs-form-readonly-control
            [value]="this.lastActualizeDate | cbsDateFormat"
            [outputType]="this.readOnlyOutput"
            fieldLabel="{{ 'LAST_ACTUALIZE_DATE' | translate }}"
            [matTooltip]="this.actualizeMsg"
        ></cbs-form-readonly-control>

        <cbs-form-lookup-control
            [hasError]="repaymentForm.get('paymentMethod').errors && repaymentForm.get('paymentMethod').touched"
            [formControlName]="'paymentMethod'"
            searchPlaceholder="{{ 'SEARCH' | translate }}"
            selectPlaceholder="{{ 'SELECT' | translate }}"
            [fieldLabel]="'PAYMENT_METHOD' | translate"
            [picklistDataUrl]="paymentMethodConfig">
        </cbs-form-lookup-control>

        <cbs-form-select-control
            [formControlName]="'repaymentType'"
            [selectData]="repaymentType"
            [requiredField]="true"
            [hasError]="repaymentForm.get('repaymentType').errors && repaymentForm.get('repaymentType').touched"
            fieldLabel="{{ 'REPAYMENT_TYPE' | translate }}"
            (onChange)="markAsEdited('repayment_type')"
        ></cbs-form-select-control>

        <cbs-form-input-control
            [formControlName]="'total'"
            [requiredField]="true"
            [inputType]="'number'"
            [hasError]="repaymentForm.get('total').errors && repaymentForm.get('total').touched"
            fieldLabel="{{ 'TOTAL' | translate }}"
            (focusout)="markAsEdited('total')">
            <div class="maxAmount">
                {{'MAX' | translate}}: <a (click)="onSetMaxAmount.emit()">{{ maxAmount }}</a>
            </div>
        </cbs-form-input-control>

        <cbs-form-input-control
            [formControlName]="'principal'"
            [requiredField]="true"
            [inputType]="'number'"
            [hasError]="repaymentForm.get('principal').errors && repaymentForm.get('principal').touched"
            fieldLabel="{{ 'PRINCIPAL' | translate }}"
            (onChange)="markAsEdited('principal_penalty')"
        ></cbs-form-input-control>

        <cbs-form-input-control
            [formControlName]="'interest'"
            [requiredField]="true"
            [inputType]="'number'"
            [hasError]="repaymentForm.get('interest').errors && repaymentForm.get('interest').touched"
            fieldLabel="{{ 'INTEREST' | translate }}"
        ></cbs-form-input-control>

        <cbs-form-input-control
            [formControlName]="'penalty'"
            [requiredField]="true"
            [inputType]="'number'"
            [hasError]="repaymentForm.get('penalty').errors && repaymentForm.get('penalty').touched"
            fieldLabel="{{ 'PENALTY' | translate }}"
            (onChange)="markAsEdited('principal_penalty')"
        ></cbs-form-input-control>

        <cbs-form-input-control
            [formControlName]="'earlyRepaymentFee'"
            [inputType]="'number'"
            [hasError]="repaymentForm.get('earlyRepaymentFee').errors && repaymentForm.get('earlyRepaymentFee').touched"
            fieldLabel="{{ 'EARLY_REPAYMENT_FEES' | translate }}"
        ></cbs-form-input-control>

    </form>
</div>
